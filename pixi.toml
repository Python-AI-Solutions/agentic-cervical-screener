[project]
name = "agentic-cervical-screener"
channels = ["conda-forge", "pytorch", "microsoft"]
platforms = ["osx-arm64", "linux-64", "osx-64", "win-64"]

[tasks]
dev = "uvicorn src.main:app --reload --host localhost --port 8000"
start = "uvicorn src.main:app --host 0.0.0.0 --port 8000"
test = "python -m pytest tests/ -x -q"
test-ci = "python -m pytest tests/ -v --tb=short"
test-integration = "python -m pytest tests/ -m integration -v"
test-coverage = "python -m pytest tests/ --cov=src --cov-report=html --cov-report=term"
install = "pip install -e '.[ml,test,dev]'"
install-browsers = "playwright install chromium"
setup = { depends-on = ["install", "install-browsers"] }
format = "pre-commit run --all-files"
lint = "ruff check src/ tests/"

[dependencies]
# Core runtime
python = "3.11.*"
pip = "*"
# System dependencies for OpenCV and image processing
glib = "*"
libjpeg-turbo = "*"
libpng = "*"
libtiff = "*"
# Use conda for PyTorch for better performance
pytorch = "==2.3.1"
torchvision = "==0.18.1"
# Everything else via pip from pyproject.toml
